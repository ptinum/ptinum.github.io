<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/data/user_macros.ico">
  <title>vue graniy</title>
<style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .chat-container {
            width: 500px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
        }
        .chat-header {
            background-color: #f1f1f1;
            padding: 10px;
            display: flex;
            align-items: center;
        }
        .chat-header h2 {
            margin: 0;
            font-size: 16px;
        }
        .chat-messages {
            padding: 20px;
            height: 600px; /* ë†’ì´ ì¦ê°€ */
            overflow-y: auto; /* ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }
        .chat-messages::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
        .message {
            margin-bottom: 0; /* ê°„ê²© ì œê±° */
            text-align: left; /* ëª¨ë“  ë©”ì‹œì§€ë¥¼ ì™¼ìª½ ì •ë ¬ */
            position: relative; /* ì‚­ì œ ë²„íŠ¼ ìœ„ì¹˜ë¥¼ ìœ„í•´ */
            max-width: 100%; /* ì´ë¯¸ì§€ê°€ ë©”ì‹œì§€ ë°•ìŠ¤ ì•ˆì— ê½‰ ì°¨ê²Œ */
        }
        .message p, .message img {
            display: inline-block;
            padding: 10px;
            border-radius: 10px;
            max-width: 70%;
        }
        .message p {
            background-color: #dcf8c6;
        }
        .delete-btn {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ì‚­ì œ ë²„íŠ¼ ìˆ¨ê¹€ */
            position: absolute;
            bottom: 5px; /* ì˜¤ë¥¸ìª½ í•˜ë‹¨ì— ìœ„ì¹˜ */
            right: 5px;
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            z-index: 10;
        }
        .message:hover .delete-btn {
            display: block; /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ì‚­ì œ ë²„íŠ¼ í‘œì‹œ */
        }
        .chat-input {
            display: flex;
            flex-direction: column; /* ìˆ˜ì§ ì •ë ¬ */
            padding: 10px;
            background-color: #f1f1f1;
            position: relative;
        }
        .chat-input-row {
            display: flex;
            align-items: center;
        }
        .chat-input input[type="text"] {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 20px;
            margin-right: 10px;
        }
        .chat-input input[type="file"] {
            display: none;
        }
        .chat-input button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        .upload-label {
            background-color: #007bff;
            color: white;
            padding: 10px;
            border-radius: 20px;
            cursor: pointer;
            margin-right: 10px;
        }
        .image-preview-box {
            background-color: rgba(213, 222, 232, 0.5); /* ì§€ì •ëœ ë°°ê²½ ìƒ‰ìƒ ë° íˆ¬ëª…ë„ */
            width: 480px;
            height: 100px;
            padding: 10px;
            position: absolute;
            top: -120px; /* ë©”ì‹œì§€ ì…ë ¥ì°½ ìœ„ì— ìœ„ì¹˜ */
            left: 50%;
            transform: translateX(-50%);
            z-index: 10; /* ë©”ì‹œì§€ ìœ„ë¡œ í‘œì‹œ */
        }
        .image-preview {
            width: 100px;
            height: 100px;
            object-fit: cover; /* ì´ë¯¸ì§€ë¥¼ 1:1 í¬ê¸°ë¡œ ë§ì¶”ê¸° */
            border-radius: 10px;
            display: inline-block; /* ì´ë¯¸ì§€ê°€ ì™¼ìª½ ì •ë ¬ë˜ê²Œ */
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h2>Chat</h2>
        </div>
        <div class="chat-messages" id="chat-messages"></div>
        <div class="chat-input">
            <div id="image-preview-box" class="image-preview-box" style="display: none;">
                <img id="image-preview" class="image-preview">
            </div>
            <div class="chat-input-row">
                <label for="file-input" class="upload-label">ğŸ“</label>
                <input type="file" id="file-input" accept="image/*" onchange="previewImage(event)">
                <input type="text" id="message-input" placeholder="Type your message here!" onkeydown="checkEnter(event)">
                <button onclick="sendMessage()">â¤</button>
            </div>
        </div>
    </div>

    <script>
        let imageSrc = '';

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë©”ì‹œì§€ ë¡œë“œ
        function loadMessages() {
            const messages = JSON.parse(localStorage.getItem('messages')) || [];
            const chatMessages = document.getElementById('chat-messages');
            chatMessages.innerHTML = '';

            messages.forEach((message, index) => {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${message.type}`;
                messageElement.dataset.index = index;

                if (message.type === 'image') {
                    const imgElement = document.createElement('img');
                    imgElement.src = message.src;
                    imgElement.alt = 'Uploaded Image';
                    messageElement.appendChild(imgElement);
                } else {
                    const textElement = document.createElement('p');
                    textElement.innerText = message.text;
                    messageElement.appendChild(textElement);
                }
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn';
                deleteBtn.innerText = 'X';
                deleteBtn.onclick = () => deleteMessage(index);
                messageElement.appendChild(deleteBtn);
                
                chatMessages.appendChild(messageElement);
            });

            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // ë©”ì‹œì§€ ì‚­ì œ
        function deleteMessage(index) {
            const messages = JSON.parse(localStorage.getItem('messages')) || [];
            messages.splice(index, 1);
            localStorage.setItem('messages', JSON.stringify(messages));
            loadMessages();
        }

        // ë©”ì‹œì§€ ì „ì†¡
        function sendMessage() {
            const messageInput = document.getElementById('message-input');
            const messageText = messageInput.value.trim();
            if (messageText === '' && imageSrc === '') return;

            const messages = JSON.parse(localStorage.getItem('messages')) || [];
            if (imageSrc) {
                messages.push({ type: 'image', src: imageSrc });
                imageSrc = '';
                document.getElementById('image-preview-box').style.display = 'none';
            } else {
                messages.push({ type: 'sent', text: messageText });
            }
            localStorage.setItem('messages', JSON.stringify(messages));

            messageInput.value = '';
            loadMessages();
        }

        // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
        function previewImage(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                imageSrc = e.target.result;
                const imagePreviewBox = document.getElementById('image-preview-box');
                const imagePreview = document.getElementById('image-preview');
                imagePreview.src = imageSrc;
                imagePreviewBox.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        // í´ë¦½ë³´ë“œ ì´ë¯¸ì§€ ì²˜ë¦¬
        document.addEventListener('paste', event => {
            const items = (event.clipboardData || event.originalEvent.clipboardData).items;
            for (let item of items) {
                if (item.type.includes('image')) {
                    const file = item.getAsFile();
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageSrc = e.target.result;
                        const imagePreviewBox = document.getElementById('image-preview-box');
                        const imagePreview = document.getElementById('image-preview');
                        imagePreview.src = imageSrc;
                        imagePreviewBox.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            }
        });

        // Enter í‚¤ ì²´í¬
        function checkEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // ì´ˆê¸° ë©”ì‹œì§€ ë¡œë“œ
        loadMessages();
    </script>
</body>
</html>
